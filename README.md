# [Movie](https://add-me-here)

![version](https://img.shields.io/badge/version-0.0.1-blue.svg)

Laravel Movie API System

## Documentation

Read full system [soon]

## Port

| # | Container | Port DEV | Port STG | Port Master |
|---|---|---|---|---|
| 1 | nginx - http | 6010 | 80 | - |
| 2 | phpmyadmin | 6011 | 8001 | - |
| 3 | mysql | 6012 | 3306 | - |
| 4 | smtp | 6013 | 1025 | - |
| 5 | mailhog | 6014 | 8025 | - |

## Requirement

#### Docker ####

Download [Docker Desktop](https://www.docker.com/products/docker-desktop/) and install on the local machine.

## Installation

Start the docker and follow below steps:

1. In your terminal, clone `git` repository:
    ```
    git clone git@github.com:eazrik/eazrik-be-8055.git
    ```

2. Navigate to root project folder:
    ```
    cd movie
    ```

3. Build `movie` docker's image:
    ```
    docker-compose build app
    ```

    OR for docker compose v2

    ```
    docker compose build app
    ```

4. Start and run the environment:
    ```
    docker-compose up -d
    ```

    OR for docker compose v2

    ```
    docker compose up -d
    ```

5. Accessing the `app` container:
    ```
    docker exec -it movie-app /bin/bash
    ```

6. Create `.env` by copying from `.env.example`:
    ```
    cp .env.example .env
    ```

7. Install Laravel's application dependencies:
    ```
    composer install
    ```

8.  Generate a unique application key with the artisan Laravel command-line tool. This key is used to encrypt user sessions and other sensitive data:
    ```
    php artisan key:generate
    ```

9. Install dependencies specified inside `package.json`:
    ```
    npm install
    ```

10. Building frontend components:
    ```
    npm run development && npm run production
    ```

11. Modify the database schema with the current schema state:
    ```
    php artisan migrate
    ```

12. Insert initial datas into the database:
    ```
    php artisan db:seed
    ```

13. Add user permission on selected folder:
    
    Note: Windows user can use [Integrity Control Access Control List](https://learn.microsoft.com/en-us/archive/msdn-magazine/2008/november/access-control-understanding-windows-file-and-registry-permissions) to change folders permission
    ```
    chmod -R 777 storage/framework && chmod -R 777 storage/app && chmod -R 777 public
    ```

Now, open browser and access [movie](http://localhost:6010) serverâ€™s domain name on port 6010:
```
http://localhost:6010
```

## phpMyadmin

Open [phpmyadmin](http://localhost:6011) login page from brower.
```
http://localhost:6011

Credential:-
Username: user
Password: test
```

## Mailhog

Local SMTP testing server.
```
SMTP_PORT = 6013
```

To test the SMTP is running properly.
Access the app container.

```
$ docker exec -it movie-app /bin/bash
$ php artisan tinker
$ Mail::send('home', [], function($message) { $message->to('test@test.com')->subject('testing'); });
```

This will send template ``home.blade.php``
To view the sent email, browse to [http://localhost:6014](http://localhost:6014)
```
http://localhost:6014
```

## Docker References

Show information of active services state:
```
docker-compose ps
```

Enter image's environment:
```
docker exec -it {IMAGE_NAME} {LOCATION}
```
Example:-
```
docker exec -it otas-app /bin/bash
```

Logs command to check the logs generated by the services:
```
docker-compose logs {SERVICE}
```
Example:-
```
docker-compose logs nginx
```

Pause Docker Compose environment while keeping the state of all its services:
```
docker-compose pause
```

Resume the services:
```
docker-compose unpause
```

Shut down Docker Cmpose environment and remove all of its containers, networks, and volumes:
```
docker-compose down
```

Copy auth bearer token from column `api_token` inside `user` table.

## Other References

Check installed laravel package:
```
composer show -i
```

## Artisan Reset

Clear cache:
```
php artisan cache:clear
```

Clear routes cache:
```
php artisan route:clear
```

Clear config:
```
php artisan config:clear
```

Wipe tables:
```
php artisan db:wipe
```
